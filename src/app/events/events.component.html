<section id="events">
  <div class="container">
    <div class="events-layout">
      <aside class="filters-sidebar">
        <div class="filters-header">
          <h3>Filtres</h3>
          <button type="button" class="clear-filters-btn" (click)="clearFilters()" 
                  [disabled]="!hasActiveFilters()">
            Réinitialiser
          </button>
        </div>

        <div class="filter-group">
          <label for="photographer-name">Nom du photographe</label>
          <input 
            id="photographer-name"
            type="text" 
            [(ngModel)]="photographerName"
            (ngModelChange)="onFiltersChange()"
            placeholder="Rechercher dans les titres..."
            class="filter-input"
          />
        </div>

        <div class="filter-group">
          <label for="min-date">Date de capture (début)</label>
          <input 
            id="min-date"
            type="date" 
            [(ngModel)]="minDate"
            (ngModelChange)="onFiltersChange()"
            class="filter-input"
          />
        </div>

        <div class="filter-group">
          <label for="max-date">Date de capture (fin)</label>
          <input 
            id="max-date"
            type="date" 
            [(ngModel)]="maxDate"
            (ngModelChange)="onFiltersChange()"
            class="filter-input"
          />
        </div>

        <div class="filter-group">
          <label for="album-select">Album</label>
          <div class="album-select-wrapper">
            <input 
              id="album-search"
              type="text" 
              [(ngModel)]="albumSearchTerm"
              placeholder="Rechercher un album..."
              class="filter-input album-search-input"
            />
            <select 
              id="album-select"
              [(ngModel)]="albumId"
              (ngModelChange)="onFiltersChange(); albumSearchTerm = ''"
              class="filter-input album-select"
            >
              <option value="">Tous les albums</option>
              <option *ngFor="let album of getFilteredAlbums()" [value]="album.id">
                {{ album.title._content }}
              </option>
            </select>
            <div *ngIf="albumsLoading()" class="album-loading">Chargement des albums...</div>
          </div>
        </div>
      </aside>

      <div class="events-section">
        <div class="section-header">
          <div>
            <div class="section-title">Photos</div>
            <div class="section-kicker">Nos derniers évènements</div>
          </div>
        </div>

        <div class="card">
          <div *ngIf="loading()" class="loading">Chargement des photos…</div>
          <div *ngIf="error()" class="error">{{ error() }}</div>

          <ng-container *ngIf="!loading() && !error()">
            <div *ngIf="getDisplayPhotos().length > 0; else noPhoto" class="photos-grid">
              <figure *ngFor="let photo of getDisplayPhotos()" class="photo-figure">
                <img [src]="getPhotoUrl(photo)" [alt]="photo.title || 'Photo Flickr'" />
                <figcaption>
                  <div class="photo-title">{{ photo.title || '(Sans titre)' }}</div>
                  <div class="photo-author">
                    par {{ photo.ownername || 'Ephemere - Collectif Photo' }}
                  </div>
                </figcaption>
              </figure>
            </div>
            
            <div *ngIf="hasMorePages()" #loadingMoreElement class="loading-more">
              <span *ngIf="loadingMore()">Chargement de plus de photos…</span>
            </div>
            
            <ng-template #noPhoto>
              <div class="empty">
                Aucune photo trouvée.
              </div>
            </ng-template>
          </ng-container>
        </div>
      </div>
    </div>
  </div>
</section>

